# CMU 15-445 课程讲义
[英文讲义](assets/cmu15-445-lectures/)

## 讲义01 关系模型和关系代数

数据库和数据库管理系统区别？
- 数据库代表的是有内在关联的数据集合，跟采用的数据模型、存储格式等无关，用于对现实世界某个方面建模（如课堂学生、社交网络）
- 数据库管理系统是用于管理数据库的软件，包含数据模型、存储格式等实现细节。

数据模型有关系模型、图模型、KV模型等众多模型。其代表数据库
- 关系模型：MySQL、PostgreSQL
- 图模型：Neo4j
- KV模型：Redis、LevelDB

关系模型的提出是为了解决什么问题？
1. 数据完整性，如“year”字段必须是数字格式
2. 逻辑层和物理层分离，上层采用关系结构抽象，下层具体存储方式由 DBMS 决定（本地文件or对象存储，行存or列存等）
3. 通过高级语言来描述想要访问的数据，具体执行策略交由 DBMS 确定，具有更灵活更强大的查询能力

关系模型定义了一种基于关系的数据库抽象。

什么是关系？
- 关系是一个包含属性的无序集合，是一种数据结构，比如 Student (age, name, gender)

关系和元组的区别？
- 关系是数据结构，包含多个属性，用于表示实体
- 元组是关系中的一行数据，也称为记录record、行row，是一个具体的实体

关系模型为什么能适应大部分场景，得到广泛运用？
- 关系数据结构本身足够简单直观易于学习，因为简单所以比较普适
- 结构化数据有利于数据组织、查询和分析
- 将逻辑层和物理层分离，更加灵活
- 提供了数据完整性约束
- 基于SQL的强大的查询能力

关系代数是一组运算，用于操纵关系，它接收一个或多个关系作为输入，输出一个新的关系。例如选择Select、并集Union、连接Join、投影Projection等。

## 讲义02 现代 SQL

SQL 和关系代数的区别？
- SQL是声明式语言，仅指出需要查询的数据，而不知道如何查找
- 关系代数是过程式的，它指定了 DBMS 执行的策略

嵌套查询为什么通常很难优化？// TODO

窗口函数是什么？
1. 窗口函数通过将元组进行分组，在每个分组上进行计算和聚合
2. 结果可以与其他列一同输出（不同于聚合函数会将多个元组聚合成一个元组，无法同其他列一同输出）

```sql
SELECT * FROM (
  SELECT *, RANK() OVER (PARTITION BY cid ORDER BY grade ASC) AS rank FROM enrolled
) AS ranking 
WHERE ranking.rank = 2;
```
以课程cid进行分组，每个分组内通过成绩grade进行排序，RANK() 则是该元组所在分组的排名值，因此真个SQL意思为：查找每⻔课程成绩第⼆⾼的学⽣。

ROW_NUMBER 和 RANK 函数区别？
- ROW_NUMBER 代表在分组内排序后的所在行号
- RANK 代表在分组内排序后的所在的排名，如果order by字段值相同的行，其排名也相同

公共表表达式是什么？为了解决什么问题？
- CTE 是为了简化复杂查询语句中各种嵌套查询的书写

## 讲义03 数据库存储（第一部分）

## 讲义04 数据库存储（第二部分）

## 讲义05 存储模型和压缩

## 讲义06 缓冲池

## 讲义07 哈希表

## 讲义08 基于树的索引

## 讲义09 索引并发控制

## 讲义10 排序和聚合算法
## 讲义11 连接算法
## 讲义12 查询执行（第一部分）
## 讲义13 查询执行（第二部分）
## 讲义14 查询计划和优化
## 讲义15 并发控制理论
## 讲义16 两阶段锁
## 讲义17 时间戳排序并发控制
## 讲义18 多版本并发控制
## 讲义19 日志记录方案
## 讲义20 数据库崩溃恢复
## 讲义21 分布式数据库介绍
## 讲义22 分布式OLTP数据库
## 讲义23 分布式OLAP数据库
## 讲义24 嵌入式数据库逻辑